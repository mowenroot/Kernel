#!/bin/sh
qemu-system-x86_64 \
    -m 4G \
    -kernel ./bzImage \
    -initrd  ./rootfs.cpio \
    -monitor /dev/null \
    -append "root=/dev/ram rdinit=/sbin/init console=ttyS0 oops=panic panic=1 quiet loglevel=3 no_hash_pointers nokaslr" \
    -cpu kvm64,+smep \
    -smp cores=2,threads=1 \
    -pidfile vm.pid \
    -nographic \
    -s \
    2>&1 | tee vm.log